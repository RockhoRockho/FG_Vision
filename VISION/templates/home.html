{% extends "base.html" %}

{% block title %}FG VISION{% endblock %}

{% block stylesheet %}
{% load static %}
<link href="{% static 'css/home.css' %}" rel="stylesheet">
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css" />
<script language = "javascript">
    json_data = [];
</script>
{% endblock %}

{% block contents %}
<div id="container">
    <div class="wrap">.
        <div class="one" style="width: 30%; height: 45%;">
            <div class="insert_img">이미지 첨부</div>
            <div class="btndiv">
                <form id="toPython" action="{% url 'home' %}" method="POST" enctype="multipart/form-data" name="topython">
                    {% csrf_token %}
                    <label class="file_btn" for="input_file">이미지 첨부</label>
                    <input type="file" id="input_file" name="input_file" accept="image/*" style="display: none;">
                    <input type="text" id="input_title" name="input_title" style="display: none;">
                </form>
            </div>
            <div id="preview_list"></div>
            <div id="preview" class="text-center">
                {% if ret %}
                <img src="{{ files }}" class="preview_img">
                {% endif %}
            </div>
        </div>
    
        <div class="two" style="width: 60%; height: 45%;">
                <div class="ans">
                    <div style="float: left; width: 30%;">양식 자동감지 결과 :</div>
                    <div style="float: left; width: 35%;">{{ title }}</div>
                    <div id="title_name" style="clear: both; width: 100%; float: left; margin-top: 5%;"></div>
                    <div style="float: left; width: 70%; margin-top: 5%;">
                    </div>
                    <div style="clear: both;text-align: center;">
                        <table id="dtable" class="table table-hover" style="margin-right: 0px;margin-left: auto;">
                            <thead style="width: 90%; border-left: none;">
                                <tr style="width: 90%;">
                                    <th style="width:13%; text-align: center;">No.</th>
                                    <th style="width:48%; text-align: center;">양식명</th>
                                    <th style="width:38%; text-align: center;">기타</th>
                                </tr>
                            </thead>

                            <tbody style="width: 90%; border-left: none;">
                                {% for d in jsonData %}
                                <!-- <div> -->
                                <tr class="form_row" onclick="myfunc()">
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ d.form_title }}</td>
                                    <td>{{ d.form_ret }}</td>
                                </tr>
                                <!-- </div> -->
                                <!-- <script language="javascript">
                                    json_data.push(JSON.parse('{{d}}'.replace(/&#x27;/g, '\"')));
                                </script> -->
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            <button id="onoff">자동감지 시작</button>    
            <button type="submit" form="toPython" id="button" class="button" disabled="true">적용하기</button>
        </div>
        <div class="three" style="width: 10%; height: 45%; margin-bottom: 5%;">
            <p>번역</p>
            <label class="switch">
                <input type="checkbox">
                <span class="slider round"></span>
            </label>
        </div>
        <hr>
        <div class="four" style="border-top: 1px solid #000; width: 90%; margin-top: 10%; height: 45%;">
            <div class="down" style="width: 100%;">
                <div style="width: 100%; float: left;">분석결과
                    <button id="csvDownloadButton">다운로드</button>
                    <div class="view" style="margin-top: 40px; clear: both; width: 100%; height: 500px; border: 1px solid green;">
                    {% if csv_files %}
                    <table id="mytable">
                        <th>
                            <td>이름</td>
                            <td>값</td>
                        </th>
                    {% for row in csv_files %}
                        <tr>
                            {% for key, value in row.items %}
                            <td>{{key}}</td>
                            <td>{{value}}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                    </table>
                    {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div style="clear: both;"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>    
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
<script src="{% static 'js/home.js' %}"></script>
{% endblock %}